<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portfolyo - Projelerim</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="stylesheet" href="css/style.css">
    <link rel="stylesheet" href="css/animations.css">
</head>
<body>
    <div id="header"></div>

    <!-- Main Content -->
    <main>
        <section class="portfolio-section fade-in">
            <div class="section-title">
                <h2>Portfolyo</h2>
                <div class="underline"></div>
            </div>
            
            <div class="portfolio-filters slide-up">
                <button class="filter-btn active" data-filter="all">Tümü</button>
                <button class="filter-btn" data-filter="web">Web</button>
                <button class="filter-btn" data-filter="mobile">Mobil</button>
                <button class="filter-btn" data-filter="design">Tasarım</button>
            </div>

            <div class="portfolio-grid slide-up">
                <!-- Portfolio items will be loaded here dynamically -->
            </div>
        </section>
    </main>

    <div id="footer"></div>

    <script src="js/menu.js"></script>
    <script>
        // Header ve Footer'ı yükle
        fetch('/header.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('header').innerHTML = data;
                
                // Active class'ı ekle
                const currentPage = window.location.pathname;
                document.querySelectorAll('.nav-link').forEach(link => {
                    if (link.getAttribute('href') === currentPage) {
                        link.classList.add('active');
                    }
                });
                document.querySelectorAll('.mobile-link').forEach(link => {
                    if (link.getAttribute('href') === currentPage) {
                        link.classList.add('active');
                    }
                });
            });

        fetch('/footer.html')
            .then(response => response.text())
            .then(data => {
                document.getElementById('footer').innerHTML = data;
            });

        // Portfolio verilerini yükle ve filtrele
        let allProjects = [];
        let currentFilter = 'all';

        async function loadPortfolio() {
            try {
                const response = await fetch('/api/portfolio');
                if (!response.ok) throw new Error('Portfolio verileri yüklenemedi');
                
                allProjects = await response.json();
                filterProjects(currentFilter);

                // Animasyonları başlat
                document.querySelectorAll('.slide-up').forEach((element, index) => {
                    element.style.animationDelay = `${index * 0.2}s`;
                });
            } catch (error) {
                console.error('Portfolio yükleme hatası:', error);
            }
        }

        function filterProjects(filter) {
            currentFilter = filter;
            const portfolioGrid = document.querySelector('.portfolio-grid');
            
            // Filtreleme butonlarını güncelle
            document.querySelectorAll('.filter-btn').forEach(btn => {
                btn.classList.toggle('active', btn.dataset.filter === filter);
            });

            // Projeleri filtrele
            const filteredProjects = filter === 'all' 
                ? allProjects 
                : allProjects.filter(project => project.technologies.toLowerCase().includes(filter));

            // Projeleri göster
            portfolioGrid.innerHTML = filteredProjects.map(project => `
                <div class="portfolio-item ${project.featured ? 'featured' : ''} slide-up">
                    <div class="portfolio-content">
                        ${project.image ? `
                            <div class="portfolio-image">
                                <img src="${project.image}" alt="${project.title}">
                            </div>
                        ` : ''}
                        <div class="portfolio-info">
                            <h3>${project.title}</h3>
                            <p>${project.description}</p>
                            <div class="tech-stack">
                                ${project.technologies.split(',').map(tech => 
                                    `<span class="tech-tag">${tech.trim()}</span>`
                                ).join('')}
                            </div>
                            <div class="portfolio-links">
                                ${project.github ? `
                                    <a href="${project.github}" target="_blank" rel="noopener noreferrer" class="github-link">
                                        <i class="fab fa-github"></i>
                                    </a>
                                ` : ''}
                                ${project.link ? `
                                    <a href="${project.link}" target="_blank" rel="noopener noreferrer" class="live-link">
                                        <i class="fas fa-external-link-alt"></i>
                                    </a>
                                ` : ''}
                            </div>
                        </div>
                    </div>
                </div>
            `).join('');

            // Yeni eklenen elementlere animasyon ekle
            document.querySelectorAll('.portfolio-item').forEach((element, index) => {
                element.style.animationDelay = `${index * 0.1}s`;
            });
        }

        // Filtreleme butonlarına event listener ekle
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.addEventListener('click', () => filterProjects(btn.dataset.filter));
        });

        // Sayfa yüklendiğinde projeleri yükle
        document.addEventListener('DOMContentLoaded', loadPortfolio);
    </script>
</body>
</html>
